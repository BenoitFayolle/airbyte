version: "0.1.0"

definitions:
  schema_loader:
    type: JsonFileSchemaLoader
    file_path: "./source_railz_ai/schemas/{{ options['schema_name'] or options['name'] }}.json"
  selector:
    extractor:
      field_pointer: ['data']
  selector_reports:
    class_name: source_railz_ai.components.RailzAiReportsSelector
    meta_fields: "{{ options['meta_fields'] }}"
    extractor:
      field_pointer: ["{{ options['extractor_field'] or 'reports' }}"]
  selector_incremental_reports:
    $ref: "*ref(definitions.selector_reports)"
    class_name: source_railz_ai.components.RailzAiIncrementalReportsSelector
    extractor:
      $ref: "*ref(definitions.selector_reports.extractor)"
  requester:
    url_base: "https://api.railz.ai/"
    http_method: "GET"
    authenticator:
      class_name: source_railz_ai.components.ShortLivedTokenAuthenticator
      url: "https://auth.railz.ai/getAccess"
      client_id: "{{ config.client_id }}"
      secret_key: "{{ config.secret_key }}"
      lifetime: "PT3600S"
  retriever:
    record_selector:
      $ref: "*ref(definitions.selector)"
    paginator:
      type: "DefaultPaginator"
      url_base: "*ref(definitions.requester.url_base)"
      page_size_option:
        inject_into: request_parameter
        field_name: "limit"
      pagination_strategy:
        type: "OffsetIncrement"
        page_size: 100
      page_token_option:
        inject_into: request_parameter
        field_name: "offset"
    requester:
      $ref: "*ref(definitions.requester)"

# Full Refresh Base:
  base_stream:
    primary_key: "id"
    retriever:
      $ref: "*ref(definitions.retriever)"
    schema_loader:
      $ref: "*ref(definitions.schema_loader)"
  businesses_stream:
    $ref: "*ref(definitions.base_stream)"
    $options:
      name: "businesses"
      path: "/businesses"
    primary_key: "businessName"
  connections_stream:
    $ref: "*ref(definitions.base_stream)"
    $options:
      name: "connections"
      path: "/connections"
    primary_key: "connectionId"

# Full Refresh Service:
  base_service_stream:
    $ref: "*ref(definitions.base_stream)"
    retriever:
      $ref: "*ref(definitions.base_stream.retriever)"
      class_name: source_railz_ai.components.RailzAiServiceRetriever
      stream_slicer:
        class_name: source_railz_ai.components.RailzAiServiceSlicer
        parent_stream_config:
          stream: "*ref(definitions.businesses_stream)"
    transformations:
      - type: AddFields
        fields:
          - path:
              - "businessName"
            value: "{{ stream_slice['businessName'] }}"
          - path:
              - "serviceName"
            value: "{{ stream_slice['serviceName'] }}"
  customers_stream:
    $ref: "*ref(definitions.base_service_stream)"
    $options:
      name: "customers"
      path: "/customers"
  accounts_stream:
    $ref: "*ref(definitions.base_service_stream)"
    $options:
      name: "accounts"
      path: "/accounts"
  inventory_stream:
    $ref: "*ref(definitions.base_service_stream)"
    $options:
      name: "inventory"
      path: "/inventory"
  tax_rates_stream:
    $ref: "*ref(definitions.base_service_stream)"
    $options:
      name: "tax_rates"
      path: "/taxRates"
  tracking_categories_stream:
    $ref: "*ref(definitions.base_service_stream)"
    $options:
      name: "tracking_categories"
      path: "/trackingCategories"
  vendors_stream:
    $ref: "*ref(definitions.base_service_stream)"
    $options:
      name: "vendors"
      path: "/vendors"
  bank_accounts_stream:
    $ref: "*ref(definitions.base_service_stream)"
    $options:
      name: "bank_accounts"
      path: "/bankAccounts"
    primary_key: "accountId"

# Base Datetime Options
  base_datetime_stream_slicer_options:
    start_datetime:
      datetime: "{{ config['start_date'] }}"
      datetime_format: "%Y-%m-%d"
    end_datetime:
      datetime: "{{ today_utc() }}"
      datetime_format: "%Y-%m-%d"
    datetime_format: "%Y-%m-%d"
    cursor_format: "%Y-%m-%dT%H:%M:%S.%f%z"
    step: P1M
    cursor_granularity: PT0.000001S
    start_time_option:
      field_name: startDate
      inject_into: "request_parameter"
    end_time_option:
      field_name: endDate
      inject_into: "request_parameter"
    cursor_field: "{{ options['stream_cursor_field'] }}"

# Incremental Reports Without Parameter:
  base_incremental_reports_without_parameter_stream:
    $ref: "*ref(definitions.base_stream)"
    retriever:
      $ref: "*ref(definitions.base_stream.retriever)"
      class_name: source_railz_ai.components.SimpleRetriever
      record_selector:
        $ref: "*ref(definitions.selector_incremental_reports)"
      stream_slicer:
        $ref: "*ref(definitions.base_datetime_stream_slicer_options)"
        class_name: source_railz_ai.components.RailzAiIncrementalReportsSlicer
        cursor_format: "%Y-%m-%dT%H:%M:%S%z"
        step: P2M
        cursor_field: "{{ options['stream_cursor_field'] or 'endDate' }}"
    primary_key: ""
    stream_cursor_field: "endDate"

# Incremental Reports:
  base_incremental_reports_month_stream:
    $ref: "*ref(definitions.base_incremental_reports_without_parameter_stream)"
    retriever:
      $ref: "*ref(definitions.base_incremental_reports_without_parameter_stream.retriever)"
      requester:
        $ref: "*ref(definitions.requester)"
        request_options_provider:
          request_parameters:
            reportFrequency: "month"
  base_incremental_reports_quarter_stream:
    $ref: "*ref(definitions.base_incremental_reports_month_stream)"
    retriever:
      $ref: "*ref(definitions.base_incremental_reports_month_stream.retriever)"
      stream_slicer:
        $ref: "*ref(definitions.base_incremental_reports_without_parameter_stream.retriever.stream_slicer)"
        step: P6M
      requester:
        $ref: "*ref(definitions.requester)"
        request_options_provider:
          request_parameters:
            reportFrequency: "quarter"
  base_incremental_reports_year_stream:
    $ref: "*ref(definitions.base_incremental_reports_month_stream)"
    retriever:
      $ref: "*ref(definitions.base_incremental_reports_month_stream.retriever)"
      stream_slicer:
        $ref: "*ref(definitions.base_incremental_reports_without_parameter_stream.retriever.stream_slicer)"
        step: P2Y
      requester:
        $ref: "*ref(definitions.requester)"
        request_options_provider:
          request_parameters:
            reportFrequency: "year"
  base_portfolio_metrics_options:
    path: "/portfolioMetrics"
    schema_name: "portfolio_metrics"
    meta_fields:
      - "startDate"
      - "endDate"
    primary_key: ""
  portfolio_metrics_month_stream:
    $ref: "*ref(definitions.base_incremental_reports_month_stream)"
    $options:
      $ref: "*ref(definitions.base_portfolio_metrics_options)"
      name: "portfolio_metrics_month"
  portfolio_metrics_quarter_stream:
    $ref: "*ref(definitions.base_incremental_reports_quarter_stream)"
    $options:
      $ref: "*ref(definitions.base_portfolio_metrics_options)"
      name: "portfolio_metrics_quarter"
  portfolio_metrics_year_stream:
    $ref: "*ref(definitions.base_incremental_reports_year_stream)"
    $options:
      $ref: "*ref(definitions.base_portfolio_metrics_options)"
      name: "portfolio_metrics_year"

# Incremental Service:
  base_incremental_service_stream:
    $ref: "*ref(definitions.base_service_stream)"
    retriever:
      $ref: "*ref(definitions.base_service_stream.retriever)"
      stream_slicer:
        $ref: "*ref(definitions.base_service_stream.retriever.stream_slicer)"
        class_name: source_railz_ai.components.RailzAiIncrementalServiceSlicer
        base_datetime_stream_slicer_options:
          $ref: "*ref(definitions.base_datetime_stream_slicer_options)"
  accounting_transactions_stream:
    $ref: "*ref(definitions.base_incremental_service_stream)"
    $options:
      name: "accounting_transactions"
      path: "/accountingTransactions"
      stream_cursor_field: "postedDate"
  bank_transfers_stream:
    $ref: "*ref(definitions.base_incremental_service_stream)"
    $options:
      name: "bank_transfers"
      path: "/bankTransfers"
      stream_cursor_field: "date"
  bills_stream:
    $ref: "*ref(definitions.base_incremental_service_stream)"
    $options:
      name: "bills"
      path: "/bills"
      stream_cursor_field: "postedDate"
  bills_credit_notes_stream:
    $ref: "*ref(definitions.base_incremental_service_stream)"
    $options:
      name: "bills_credit_notes"
      path: "/bills/creditNotes"
      stream_cursor_field: "postedDate"
  bills_payments_stream:
    $ref: "*ref(definitions.base_incremental_service_stream)"
    $options:
      name: "bills_payments"
      path: "/bills/payments"
      stream_cursor_field: "date"
  deposits_stream:
    $ref: "*ref(definitions.base_incremental_service_stream)"
    $options:
      name: "deposits"
      path: "/deposits"
      stream_cursor_field: "postedDate"
  estimates_stream:
    $ref: "*ref(definitions.base_incremental_service_stream)"
    $options:
      name: "estimates"
      path: "/estimates"
      stream_cursor_field: "postedDate"
  invoices_stream:
    $ref: "*ref(definitions.base_incremental_service_stream)"
    $options:
      name: "invoices"
      path: "/invoices"
      stream_cursor_field: "postedDate"
  invoices_credit_notes_stream:
    $ref: "*ref(definitions.base_incremental_service_stream)"
    $options:
      name: "invoices_credit_notes"
      path: "/invoices/creditNotes"
      stream_cursor_field: "postedDate"
  invoices_payments_stream:
    $ref: "*ref(definitions.base_incremental_service_stream)"
    $options:
      name: "invoices_payments"
      path: "/invoices/payments"
      stream_cursor_field: "date"
  journal_entries_stream:
    $ref: "*ref(definitions.base_incremental_service_stream)"
    $options:
      name: "journal_entries"
      path: "/journalEntries"
      stream_cursor_field: "postedDate"
  purchase_orders_stream:
    $ref: "*ref(definitions.base_incremental_service_stream)"
    $options:
      name: "purchase_orders"
      path: "/purchaseOrders"
      stream_cursor_field: "postedDate"
  refunds_stream:
    $ref: "*ref(definitions.base_incremental_service_stream)"
    $options:
      name: "refunds"
      path: "/refunds"
      stream_cursor_field: "date"
  commerce_disputes_stream:
    $ref: "*ref(definitions.base_incremental_service_stream)"
    $options:
      name: "commerce_disputes"
      path: "/commerce/disputes"
      stream_cursor_field: "createdDate"
  commerce_orders_stream:
    $ref: "*ref(definitions.base_incremental_service_stream)"
    $options:
      name: "commerce_orders"
      path: "/commerce/orders"
      stream_cursor_field: "createdDate"
  commerce_products_stream:
    $ref: "*ref(definitions.base_incremental_service_stream)"
    $options:
      name: "commerce_products"
      path: "/commerce/products"
      stream_cursor_field: "createdDate"
  commerce_transactions_stream:
    $ref: "*ref(definitions.base_incremental_service_stream)"
    $options:
      name: "commerce_transactions"
      path: "/commerce/transactions"
      stream_cursor_field: "createdDate"

# Incremental Service Reports Without Parameter:
  base_incremental_service_reports_month_without_parameter_stream:
    $ref: "*ref(definitions.base_incremental_service_stream)"
    retriever:
      $ref: "*ref(definitions.base_incremental_service_stream.retriever)"
      class_name: source_railz_ai.components.RailzAiServiceRetriever
      record_selector:
        $ref: "*ref(definitions.selector_incremental_reports)"
      stream_slicer:
        $ref: "*ref(definitions.base_incremental_service_stream.retriever.stream_slicer)"
        class_name: source_railz_ai.components.RailzAiIncrementalServiceReportsSlicer
        base_datetime_stream_slicer_options:
          $ref: "*ref(definitions.base_incremental_service_stream.retriever.stream_slicer.base_datetime_stream_slicer_options)"
          cursor_format: "%Y-%m-%dT%H:%M:%S%z"
          step: P2M
          cursor_field: "{{ options['stream_cursor_field'] or 'endDate' }}"
    primary_key: ""
    stream_cursor_field: "endDate"
  bank_transactions_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_month_without_parameter_stream)"
    $options:
      name: "bank_transactions"
      path: "/bankTransactions"
  business_valuations_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_month_without_parameter_stream)"
    $options:
      name: "business_valuations"
      path: "/businessValuations"
  credit_ratings_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_month_without_parameter_stream)"
    $options:
      name: "credit_ratings"
      path: "/creditRatings"
  credit_scores_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_month_without_parameter_stream)"
    $options:
      name: "credit_scores"
      path: "/creditScores"
  probability_of_default_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_month_without_parameter_stream)"
    $options:
      name: "probability_of_default"
      path: "/probabilityOfDefault"

  # Incremental Service Reports:
  base_incremental_service_reports_month_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_month_without_parameter_stream)"
    retriever:
      $ref: "*ref(definitions.base_incremental_service_reports_month_without_parameter_stream.retriever)"
      requester:
        $ref: "*ref(definitions.requester)"
        request_options_provider:
          request_parameters:
            reportFrequency: "month"
  base_incremental_service_reports_quarter_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_month_stream)"
    retriever:
      $ref: "*ref(definitions.base_incremental_service_reports_month_stream.retriever)"
      stream_slicer:
        $ref: "*ref(definitions.base_incremental_service_reports_month_without_parameter_stream.retriever.stream_slicer)"
        base_datetime_stream_slicer_options:
          $ref: "*ref(definitions.base_incremental_service_reports_month_without_parameter_stream.retriever.stream_slicer.base_datetime_stream_slicer_options)"
          step: P6M
      requester:
        $ref: "*ref(definitions.requester)"
        request_options_provider:
          request_parameters:
            reportFrequency: "quarter"
  base_incremental_service_reports_year_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_month_stream)"
    retriever:
      $ref: "*ref(definitions.base_incremental_service_reports_month_stream.retriever)"
      stream_slicer:
        $ref: "*ref(definitions.base_incremental_service_reports_month_without_parameter_stream.retriever.stream_slicer)"
        base_datetime_stream_slicer_options:
          $ref: "*ref(definitions.base_incremental_service_reports_month_without_parameter_stream.retriever.stream_slicer.base_datetime_stream_slicer_options)"
          step: P2Y
      requester:
        $ref: "*ref(definitions.requester)"
        request_options_provider:
          request_parameters:
            reportFrequency: "year"
  base_ap_aging_options:
    path: "/apAging"
    schema_name: "ap_aging"
  ap_aging_month_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_month_stream)"
    $options:
      $ref: "*ref(definitions.base_ap_aging_options)"
      name: "ap_aging_month"
  ap_aging_quarter_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_quarter_stream)"
    $options:
      $ref: "*ref(definitions.base_ap_aging_options)"
      name: "ap_aging_quarter"
  ap_aging_year_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_year_stream)"
    $options:
      $ref: "*ref(definitions.base_ap_aging_options)"
      name: "ap_aging_year"
  base_ar_aging_options:
    path: "/arAging"
    schema_name: "ar_aging"
  ar_aging_month_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_month_stream)"
    $options:
      $ref: "*ref(definitions.base_ar_aging_options)"
      name: "ar_aging_month"
  ar_aging_quarter_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_quarter_stream)"
    $options:
      $ref: "*ref(definitions.base_ar_aging_options)"
      name: "ar_aging_quarter"
  ar_aging_year_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_year_stream)"
    $options:
      $ref: "*ref(definitions.base_ar_aging_options)"
      name: "ar_aging_year"
  base_balance_sheets_options:
    path: "/balanceSheets"
    schema_name: "balance_sheets"
  balance_sheets_month_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_month_stream)"
    $options:
      $ref: "*ref(definitions.base_balance_sheets_options)"
      name: "balance_sheets_month"
  balance_sheets_quarter_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_quarter_stream)"
    $options:
      $ref: "*ref(definitions.base_balance_sheets_options)"
      name: "balance_sheets_quarter"
  balance_sheets_year_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_year_stream)"
    $options:
      $ref: "*ref(definitions.base_balance_sheets_options)"
      name: "balance_sheets_year"
  base_cashflow_statements_options:
    path: "/cashflowStatements"
    schema_name: "cashflow_statements"
  cashflow_statements_month_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_month_stream)"
    $options:
      $ref: "*ref(definitions.base_cashflow_statements_options)"
      name: "cashflow_statements_month"
  cashflow_statements_quarter_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_quarter_stream)"
    $options:
      $ref: "*ref(definitions.base_cashflow_statements_options)"
      name: "cashflow_statements_quarter"
  cashflow_statements_year_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_year_stream)"
    $options:
      $ref: "*ref(definitions.base_cashflow_statements_options)"
      name: "cashflow_statements_year"
  base_income_statements_options:
    path: "/incomeStatements"
    schema_name: "income_statements"
  income_statements_month_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_month_stream)"
    $options:
      $ref: "*ref(definitions.base_income_statements_options)"
      name: "income_statements_month"
  income_statements_quarter_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_quarter_stream)"
    $options:
      $ref: "*ref(definitions.base_income_statements_options)"
      name: "income_statements_quarter"
  income_statements_year_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_year_stream)"
    $options:
      $ref: "*ref(definitions.base_income_statements_options)"
      name: "income_statements_year"
  base_trial_balances_options:
    path: "/trialBalances"
    schema_name: "trial_balances"
  trial_balances_month_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_month_stream)"
    $options:
      $ref: "*ref(definitions.base_trial_balances_options)"
      name: "trial_balances_month"
  trial_balances_quarter_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_quarter_stream)"
    $options:
      $ref: "*ref(definitions.base_trial_balances_options)"
      name: "trial_balances_quarter"
  trial_balances_year_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_year_stream)"
    $options:
      $ref: "*ref(definitions.base_trial_balances_options)"
      name: "trial_balances_year"
  base_fraud_risk_metrics_options:
    path: "/fraudRiskMetrics"
    schema_name: "fraud_risk_metrics"
  fraud_risk_metrics_month_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_month_stream)"
    $options:
      $ref: "*ref(definitions.base_fraud_risk_metrics_options)"
      name: "fraud_risk_metrics_month"
  fraud_risk_metrics_quarter_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_quarter_stream)"
    $options:
      $ref: "*ref(definitions.base_fraud_risk_metrics_options)"
      name: "fraud_risk_metrics_quarter"
  fraud_risk_metrics_year_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_year_stream)"
    $options:
      $ref: "*ref(definitions.base_fraud_risk_metrics_options)"
      name: "fraud_risk_metrics_year"
  base_financial_ratios_options:
    path: "/financialRatios"
    schema_name: "financial_ratios"
    extractor_field: "ratios"
  financial_ratios_month_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_month_stream)"
    $options:
      $ref: "*ref(definitions.base_financial_ratios_options)"
      name: "financial_ratios_month"
  financial_ratios_quarter_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_quarter_stream)"
    $options:
      $ref: "*ref(definitions.base_financial_ratios_options)"
      name: "financial_ratios_quarter"
  financial_ratios_year_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_year_stream)"
    $options:
      $ref: "*ref(definitions.base_financial_ratios_options)"
      name: "financial_ratios_year"

# Incremental Service Reports With financialStatementType Parameter
  base_incremental_service_reports_month_with_financial_statement_type_parameter_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_month_without_parameter_stream)"
    retriever:
      $ref: "*ref(definitions.base_incremental_service_reports_month_without_parameter_stream.retriever)"
      requester:
        $ref: "*ref(definitions.requester)"
        request_options_provider:
          request_parameters:
            reportFrequency: "month"
            financialStatementType: "{{ options['request_parameters']['financial_statement_type'] }}"
  base_incremental_service_reports_quarter_with_financial_statement_type_parameter_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_month_with_financial_statement_type_parameter_stream)"
    retriever:
      $ref: "*ref(definitions.base_incremental_service_reports_month_with_financial_statement_type_parameter_stream.retriever)"
      stream_slicer:
        $ref: "*ref(definitions.base_incremental_service_reports_month_without_parameter_stream.retriever.stream_slicer)"
        base_datetime_stream_slicer_options:
          $ref: "*ref(definitions.base_incremental_service_reports_month_without_parameter_stream.retriever.stream_slicer.base_datetime_stream_slicer_options)"
          step: P6M
      requester:
        $ref: "*ref(definitions.requester)"
        request_options_provider:
          $ref: "*ref(definitions.base_incremental_service_reports_month_with_financial_statement_type_parameter_stream.retriever.requester.request_options_provider)"
          request_parameters:
            $ref: "*ref(definitions.base_incremental_service_reports_month_with_financial_statement_type_parameter_stream.retriever.requester.request_options_provider.request_parameters)"
            reportFrequency: "quarter"
  base_incremental_service_reports_year_with_financial_statement_type_parameter_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_month_with_financial_statement_type_parameter_stream)"
    retriever:
      $ref: "*ref(definitions.base_incremental_service_reports_month_with_financial_statement_type_parameter_stream.retriever)"
      stream_slicer:
        $ref: "*ref(definitions.base_incremental_service_reports_month_without_parameter_stream.retriever.stream_slicer)"
        base_datetime_stream_slicer_options:
          $ref: "*ref(definitions.base_incremental_service_reports_month_without_parameter_stream.retriever.stream_slicer.base_datetime_stream_slicer_options)"
          step: P2Y
      requester:
        $ref: "*ref(definitions.base_incremental_service_reports_month_with_financial_statement_type_parameter_stream.retriever.requester)"
        request_options_provider:
          $ref: "*ref(definitions.base_incremental_service_reports_month_with_financial_statement_type_parameter_stream.retriever.requester.request_options_provider)"
          request_parameters:
            $ref: "*ref(definitions.base_incremental_service_reports_month_with_financial_statement_type_parameter_stream.retriever.requester.request_options_provider.request_parameters)"
            reportFrequency: "year"
  base_financial_forecasts_options:
    path: "/financialForecasts"
    schema_name: "financial_forecasts"
  financial_forecasts_month_balance_sheets_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_month_with_financial_statement_type_parameter_stream)"
    $options:
      $ref: "*ref(definitions.base_financial_forecasts_options)"
      name: "financial_forecasts_month_balance_sheets"
      request_parameters:
        financial_statement_type: "balanceSheets"
  financial_forecasts_month_income_statements_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_month_with_financial_statement_type_parameter_stream)"
    $options:
      $ref: "*ref(definitions.base_financial_forecasts_options)"
      name: "financial_forecasts_month_income_statements"
      request_parameters:
        financial_statement_type: "incomeStatements"
  financial_forecasts_month_cashflow_statements_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_month_with_financial_statement_type_parameter_stream)"
    $options:
      $ref: "*ref(definitions.base_financial_forecasts_options)"
      name: "financial_forecasts_month_cashflow_statements"
      request_parameters:
        financial_statement_type: "cashflowStatements"
  financial_forecasts_quarter_balance_sheets_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_quarter_with_financial_statement_type_parameter_stream)"
    $options:
      $ref: "*ref(definitions.base_financial_forecasts_options)"
      name: "financial_forecasts_quarter_balance_sheets"
      request_parameters:
        financial_statement_type: "balanceSheets"
  financial_forecasts_quarter_income_statements_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_quarter_with_financial_statement_type_parameter_stream)"
    $options:
      $ref: "*ref(definitions.base_financial_forecasts_options)"
      name: "financial_forecasts_quarter_income_statements"
      request_parameters:
        financial_statement_type: "incomeStatements"
  financial_forecasts_quarter_cashflow_statements_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_quarter_with_financial_statement_type_parameter_stream)"
    $options:
      $ref: "*ref(definitions.base_financial_forecasts_options)"
      name: "financial_forecasts_quarter_cashflow_statements"
      request_parameters:
        financial_statement_type: "cashflowStatements"
  financial_forecasts_year_balance_sheets_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_year_with_financial_statement_type_parameter_stream)"
    $options:
      $ref: "*ref(definitions.base_financial_forecasts_options)"
      name: "financial_forecasts_year_balance_sheets"
      request_parameters:
        financial_statement_type: "balanceSheets"
  financial_forecasts_year_income_statements_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_year_with_financial_statement_type_parameter_stream)"
    $options:
      $ref: "*ref(definitions.base_financial_forecasts_options)"
      name: "financial_forecasts_year_income_statements"
      request_parameters:
        financial_statement_type: "incomeStatements"
  financial_forecasts_year_cashflow_statements_stream:
    $ref: "*ref(definitions.base_incremental_service_reports_year_with_financial_statement_type_parameter_stream)"
    $options:
      $ref: "*ref(definitions.base_financial_forecasts_options)"
      name: "financial_forecasts_year_cashflow_statements"
      request_parameters:
        financial_statement_type: "cashflowStatements"

streams:
# Full Refresh
  - "*ref(definitions.businesses_stream)"
  - "*ref(definitions.connections_stream)"
# Full Refresh Service
  - "*ref(definitions.customers_stream)"
  - "*ref(definitions.accounts_stream)"
  - "*ref(definitions.inventory_stream)"
  - "*ref(definitions.tax_rates_stream)"
  - "*ref(definitions.tracking_categories_stream)"
  - "*ref(definitions.vendors_stream)"
  - "*ref(definitions.bank_accounts_stream)"
# Incremental Reports
  - "*ref(definitions.portfolio_metrics_month_stream)"
  - "*ref(definitions.portfolio_metrics_quarter_stream)"
  - "*ref(definitions.portfolio_metrics_year_stream)"
# Incremental Service
  - "*ref(definitions.accounting_transactions_stream)"
  - "*ref(definitions.bank_transfers_stream)"
  - "*ref(definitions.bills_stream)"
  - "*ref(definitions.bills_credit_notes_stream)"
  - "*ref(definitions.bills_payments_stream)"
  - "*ref(definitions.deposits_stream)"
  - "*ref(definitions.estimates_stream)"
  - "*ref(definitions.invoices_stream)"
  - "*ref(definitions.invoices_credit_notes_stream)"
  - "*ref(definitions.invoices_payments_stream)"
  - "*ref(definitions.journal_entries_stream)"
  - "*ref(definitions.purchase_orders_stream)"
  - "*ref(definitions.refunds_stream)"
  - "*ref(definitions.commerce_disputes_stream)"
  - "*ref(definitions.commerce_orders_stream)"
  - "*ref(definitions.commerce_products_stream)"
  - "*ref(definitions.commerce_transactions_stream)"
# Incremental Service Reports Without Parameter:
  - "*ref(definitions.bank_transactions_stream)"
  - "*ref(definitions.business_valuations_stream)"
  - "*ref(definitions.credit_ratings_stream)"
  - "*ref(definitions.credit_scores_stream)"
  - "*ref(definitions.probability_of_default_stream)"
# Incremental Service Reports
  - "*ref(definitions.ap_aging_month_stream)"
  - "*ref(definitions.ap_aging_quarter_stream)"
  - "*ref(definitions.ap_aging_year_stream)"
  - "*ref(definitions.ar_aging_month_stream)"
  - "*ref(definitions.ar_aging_quarter_stream)"
  - "*ref(definitions.ar_aging_year_stream)"
  - "*ref(definitions.balance_sheets_month_stream)"
  - "*ref(definitions.balance_sheets_quarter_stream)"
  - "*ref(definitions.balance_sheets_year_stream)"
  - "*ref(definitions.cashflow_statements_month_stream)"
  - "*ref(definitions.cashflow_statements_quarter_stream)"
  - "*ref(definitions.cashflow_statements_year_stream)"
  - "*ref(definitions.income_statements_month_stream)"
  - "*ref(definitions.income_statements_quarter_stream)"
  - "*ref(definitions.income_statements_year_stream)"
  - "*ref(definitions.trial_balances_month_stream)"
  - "*ref(definitions.trial_balances_quarter_stream)"
  - "*ref(definitions.trial_balances_year_stream)"
  - "*ref(definitions.fraud_risk_metrics_month_stream)"
  - "*ref(definitions.fraud_risk_metrics_quarter_stream)"
  - "*ref(definitions.fraud_risk_metrics_year_stream)"
  - "*ref(definitions.financial_ratios_month_stream)"
  - "*ref(definitions.financial_ratios_quarter_stream)"
  - "*ref(definitions.financial_ratios_year_stream)"
# Incremental Service Reports With financialStatementType Parameter
  - "*ref(definitions.financial_forecasts_month_balance_sheets_stream)"
  - "*ref(definitions.financial_forecasts_month_income_statements_stream)"
  - "*ref(definitions.financial_forecasts_month_cashflow_statements_stream)"
  - "*ref(definitions.financial_forecasts_quarter_balance_sheets_stream)"
  - "*ref(definitions.financial_forecasts_quarter_income_statements_stream)"
  - "*ref(definitions.financial_forecasts_quarter_cashflow_statements_stream)"
  - "*ref(definitions.financial_forecasts_year_balance_sheets_stream)"
  - "*ref(definitions.financial_forecasts_year_income_statements_stream)"
  - "*ref(definitions.financial_forecasts_year_cashflow_statements_stream)"

check:
  stream_names:
    - "businesses"
